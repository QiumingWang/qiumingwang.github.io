---
title: å•ä¾‹æ¨¡å¼
subtitle: 
date: 2024-05-02 14:18:59 +0800
categories:
  - è®¾è®¡æ¨¡å¼
tags:
  - è®¾è®¡æ¨¡å¼
  - carl
published: true
image:
---
* content
{:toc}


# å•ä¾‹æ¨¡å¼

### é¢˜ç›®é“¾æ¥

[å•ä¾‹æ¨¡å¼-å°æ˜çš„è´­ç‰©è½¦](https://kamacoder.com/problempage.php?pid=1074)

### ä»€ä¹ˆæ˜¯å•ä¾‹è®¾è®¡æ¨¡å¼

å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§**åˆ›å»ºå‹è®¾è®¡æ¨¡å¼**ï¼Œ å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ä¿è¯**ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹æ¥è®¿é—®è¿™ä¸ªå®ä¾‹ã€‚**

- åªæœ‰ä¸€ä¸ªå®ä¾‹çš„æ„æ€æ˜¯ï¼Œåœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œåªå­˜åœ¨è¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œè€Œä¸æ˜¯åˆ›å»ºå¤šä¸ªç›¸åŒç±»å‹çš„å¯¹è±¡ã€‚
- å…¨å±€è®¿é—®ç‚¹çš„æ„æ€æ˜¯ï¼Œä¸ºäº†è®©å…¶ä»–ç±»èƒ½å¤Ÿè·å–åˆ°è¿™ä¸ªå”¯ä¸€å®ä¾‹ï¼Œè¯¥ç±»æä¾›äº†ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼‰ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•å°±èƒ½è·å¾—å®ä¾‹ã€‚

### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹è®¾è®¡æ¨¡å¼å‘¢

ç®€æ˜“æ¥è¯´ï¼Œå•ä¾‹è®¾è®¡æ¨¡å¼æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹è®©æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨å®ƒï¼š

- å…¨å±€æ§åˆ¶ï¼šä¿è¯åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œè¿™æ ·å°±å¯ä»¥ä¸¥æ ¼çš„æ§åˆ¶å®¢æˆ·æ€æ ·è®¿é—®å®ƒä»¥åŠä½•æ—¶è®¿é—®å®ƒï¼Œç®€å•çš„è¯´å°±æ˜¯å¯¹å”¯ä¸€å®ä¾‹çš„å—æ§è®¿é—®ï¼ˆå¼•ç”¨è‡ªã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹ç¬¬21ç« ï¼‰
- èŠ‚çœèµ„æºï¼šä¹Ÿæ­£æ˜¯å› ä¸ºåªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ï¼Œå°±é¿å…å¤šæ¬¡åˆ›å»ºäº†ç›¸åŒçš„å¯¹è±¡ï¼Œä»è€ŒèŠ‚çœäº†ç³»ç»Ÿèµ„æºï¼Œè€Œä¸”å¤šä¸ªæ¨¡å—è¿˜å¯ä»¥é€šè¿‡å•ä¾‹å®ä¾‹å…±äº«æ•°æ®ã€‚
- æ‡’åŠ è½½ï¼šå•ä¾‹æ¨¡å¼å¯ä»¥å®ç°æ‡’åŠ è½½ï¼Œåªæœ‰åœ¨éœ€è¦æ—¶æ‰è¿›è¡Œå®ä¾‹åŒ–ï¼Œè¿™æ— ç–‘ä¼šæé«˜ç¨‹åºçš„æ€§èƒ½ã€‚

### å•ä¾‹è®¾è®¡æ¨¡å¼çš„åŸºæœ¬è¦æ±‚

æƒ³è¦å®ç°ä¸€ä¸ªå•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œå¿…é¡»éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š

- ç§æœ‰çš„æ„é€ å‡½æ•°ï¼šé˜²æ­¢å¤–éƒ¨ä»£ç ç›´æ¥åˆ›å»ºç±»çš„å®ä¾‹
- ç§æœ‰çš„é™æ€å®ä¾‹å˜é‡ï¼šä¿å­˜è¯¥ç±»çš„å”¯ä¸€å®ä¾‹
- å…¬æœ‰çš„é™æ€æ–¹æ³•ï¼šé€šè¿‡å…¬æœ‰çš„é™æ€æ–¹æ³•æ¥è·å–ç±»çš„å®ä¾‹

![image-20240104113824985](https://kstar-1253855093.cos.ap-nanjing.myqcloud.com/baguwen1.0/image-20240104113824985.png)

### å•ä¾‹è®¾è®¡æ¨¡å¼çš„å®ç°

å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼æœ‰å¤šç§ï¼ŒåŒ…æ‹¬æ‡’æ±‰å¼ã€é¥¿æ±‰å¼ç­‰ã€‚

é¥¿æ±‰å¼æŒ‡çš„æ˜¯åœ¨**ç±»åŠ è½½æ—¶å°±å·²ç»å®Œæˆäº†å®ä¾‹çš„åˆ›å»º**ï¼Œä¸ç®¡åé¢åˆ›å»ºçš„å®ä¾‹æœ‰æ²¡æœ‰ä½¿ç”¨ï¼Œå…ˆåˆ›å»ºå†è¯´ï¼Œæ‰€ä»¥å«åš
â€œé¥¿æ±‰â€ã€‚

è€Œæ‡’æ±‰å¼æŒ‡çš„æ˜¯åªæœ‰åœ¨è¯·æ±‚å®ä¾‹æ—¶æ‰ä¼šåˆ›å»ºï¼Œå¦‚æœåœ¨é¦–æ¬¡è¯·æ±‚æ—¶è¿˜æ²¡æœ‰åˆ›å»ºï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå¦‚æœå·²ç»åˆ›å»ºï¼Œå°±è¿”å›å·²æœ‰çš„å®ä¾‹ï¼Œæ„æ€å°±æ˜¯**éœ€è¦ä½¿ç”¨äº†å†åˆ›å»º**ï¼Œæ‰€ä»¥ç§°ä¸ºâ€œæ‡’æ±‰â€ã€‚

åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œç”±äºé¥¿æ±‰å¼åœ¨ç¨‹åºå¯åŠ¨é˜¶æ®µå°±å®Œæˆäº†å®ä¾‹çš„åˆå§‹åŒ–ï¼Œå› æ­¤ä¸å­˜åœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶å°è¯•åˆå§‹åŒ–å®ä¾‹çš„é—®é¢˜ï¼Œä½†æ˜¯æ‡’æ±‰å¼ä¸­å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—® `getInstance()` æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨åŒä¸€æ—¶åˆ»æ£€æµ‹åˆ°å®ä¾‹æ²¡æœ‰è¢«åˆ›å»ºï¼Œå°±å¯èƒ½ä¼šåŒæ—¶åˆ›å»ºå®ä¾‹ï¼Œä»è€Œå¯¼è‡´å¤šä¸ªå®ä¾‹è¢«åˆ›å»ºï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸€äº›åŒæ­¥æœºåˆ¶ï¼Œä¾‹å¦‚ä½¿ç”¨äº’æ–¥é”æ¥ç¡®ä¿åœ¨ä»»ä½•æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿæ‰§è¡Œå®ä¾‹çš„åˆ›å»ºã€‚

> ä¸¾ä¸ªä¾‹å­ï¼Œä½ å’Œå°æ˜éƒ½å‘ç°å®¶é‡Œæ²¡ç±³äº†ï¼Œåœ¨ä½ ä»¬æ²¡æœ‰ç›¸äº’é€šçŸ¥çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¼šå»è¶…å¸‚ä¹°ä¸€è¢‹ç±³ï¼Œè¿™æ ·å°±é‡å¤è´­ä¹°äº†ï¼Œè¿èƒŒäº†å•ä¾‹æ¨¡å¼ã€‚

ä¸‹é¢ä»¥Javaçš„ä»£ç ä½œä¸ºå®ä¾‹ï¼Œè¯´æ˜å•ä¾‹è®¾è®¡æ¨¡å¼çš„åŸºæœ¬å†™æ³•ï¼š

1. é¥¿æ±‰æ¨¡å¼ï¼šå®ä¾‹åœ¨ç±»åŠ è½½æ—¶å°±è¢«åˆ›å»º, è¿™ç§æ–¹å¼çš„å®ç°ç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯å®ä¾‹æœ‰å¯èƒ½æ²¡æœ‰ä½¿ç”¨è€Œé€ æˆèµ„æºæµªè´¹ã€‚


```java

public class Singleton {
	// ğŸŒŸğŸŒŸ
    private static final Singleton instance = new Singleton();
    
    private Singleton() {
        // ç§æœ‰æ„é€ æ–¹æ³•ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ–
    }
    
    public static Singleton getInstance() {
        return instance;
    }
}

```


2. æ‡’æ±‰æ¨¡å¼ï¼šç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰åˆ›å»º


```java

public class Singleton {
    private static Singleton instance;
    
    private Singleton() {
        // ç§æœ‰æ„é€ æ–¹æ³•ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ–
    }
    // ä½¿ç”¨äº†åŒæ­¥å…³é”®å­—æ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨, å¯èƒ½ä¼šå½±å“æ€§èƒ½
    public static synchronized Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}

```


åœ¨æ‡’æ±‰æ¨¡å¼çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥ä½¿ç”¨åŒé‡æ£€æŸ¥é”æ¥æé«˜æ€§èƒ½ã€‚


```java

public class Singleton {
    private static volatile Singleton instance;
    
    private Singleton() {
        // ç§æœ‰æ„é€ æ–¹æ³•ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ–
    }
    
    public static Singleton getInstance() {
        if (instance == null) {
            synchronized (Singleton.class) {
                if (instance == null) {
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}

```


### ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å•ä¾‹è®¾è®¡æ¨¡å¼

è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹åº”è¯¥è€ƒè™‘ä½¿ç”¨å•ä¾‹è®¾è®¡æ¨¡å¼å‘¢ï¼Ÿå¯ä»¥ç»“åˆå•ä¾‹è®¾è®¡æ¨¡å¼çš„ä¼˜ç‚¹æ¥çœ‹ã€‚

1. èµ„æºå…±äº«

å¤šä¸ªæ¨¡å—å…±äº«æŸä¸ªèµ„æºçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚è¯´åº”ç”¨ç¨‹åºéœ€è¦ä¸€ä¸ªå…¨å±€çš„é…ç½®ç®¡ç†å™¨æ¥å­˜å‚¨å’Œç®¡ç†é…ç½®ä¿¡æ¯ã€äº¦æˆ–æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼ç®¡ç†æ•°æ®åº“è¿æ¥æ± ã€‚

2. åªæœ‰ä¸€ä¸ªå®ä¾‹

å½“ç³»ç»Ÿä¸­æŸä¸ªç±»åªéœ€è¦ä¸€ä¸ªå®ä¾‹æ¥åè°ƒè¡Œä¸ºçš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œ æ¯”å¦‚è¯´ç®¡ç†åº”ç”¨ç¨‹åºä¸­çš„ç¼“å­˜ï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªç¼“å­˜å®ä¾‹ï¼Œé¿å…é‡å¤çš„ç¼“å­˜åˆ›å»ºå’Œç®¡ç†ï¼Œæˆ–è€…ä½¿ç”¨å•ä¾‹æ¨¡å¼æ¥åˆ›å»ºå’Œç®¡ç†çº¿ç¨‹æ± ã€‚

3. æ‡’åŠ è½½

å¦‚æœå¯¹è±¡åˆ›å»ºæœ¬èº«å°±æ¯”è¾ƒæ¶ˆè€—èµ„æºï¼Œè€Œä¸”å¯èƒ½åœ¨æ•´ä¸ªç¨‹åºä¸­éƒ½ä¸ä¸€å®šä¼šä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼å®ç°æ‡’åŠ è½½ã€‚

åœ¨è®¸å¤šæµè¡Œçš„å·¥å…·å’Œåº“ä¸­ï¼Œä¹Ÿéƒ½ä½¿ç”¨åˆ°äº†å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œæ¯”å¦‚Javaä¸­çš„`Runtime`ç±»å°±æ˜¯ä¸€ä¸ªç»å…¸çš„å•ä¾‹ï¼Œè¡¨ç¤ºç¨‹åºçš„è¿è¡Œæ—¶ç¯å¢ƒã€‚æ­¤å¤– Spring æ¡†æ¶ä¸­çš„åº”ç”¨ä¸Šä¸‹æ–‡ (`ApplicationContext`) ä¹Ÿè¢«è®¾è®¡ä¸ºå•ä¾‹ï¼Œä»¥æä¾›å¯¹åº”ç”¨ç¨‹åºä¸­æ‰€æœ‰ bean çš„é›†ä¸­å¼è®¿é—®ç‚¹ã€‚

### æœ¬é“é¢˜ç›®ä»£ç 


```c++

import java.util.LinkedHashMap;
import java.util.Map;
import java.util.Scanner;

public class Main {

    public static void main(String[] args) {
        ShoppingCartManager cart = ShoppingCartManager.getInstance();
        Scanner scanner = new Scanner(System.in);

        while (scanner.hasNext()) {
            String itemName = scanner.next();
            int quantity = scanner.nextInt();

            // è·å–è´­ç‰©è½¦å®ä¾‹å¹¶æ·»åŠ å•†å“
            cart.addToCart(itemName, quantity);
        }

        // è¾“å‡ºè´­ç‰©è½¦å†…å®¹
        cart.viewCart();
    }
}

class ShoppingCartManager {

    // é¥¿æ±‰æ¨¡å¼å®ç°å•ä¾‹
    private static final ShoppingCartManager instance = new ShoppingCartManager();

    // è´­ç‰©è½¦å­˜å‚¨å•†å“å’Œæ•°é‡çš„æ˜ å°„
    private Map<String, Integer> cart;

    // ç§æœ‰æ„é€ å‡½æ•°
    private ShoppingCartManager() {
        cart = new LinkedHashMap<>(); 
    }

    // è·å–è´­ç‰©è½¦å®ä¾‹
    public static ShoppingCartManager getInstance() {
        return instance;
    }

    // æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
    public void addToCart(String itemName, int quantity) {
        cart.put(itemName, cart.getOrDefault(itemName, 0) + quantity);
    }

    // æŸ¥çœ‹è´­ç‰©è½¦
    public void viewCart() {
        for (Map.Entry<String, Integer> entry : cart.entrySet()) {
            System.out.println(entry.getKey() + " " + entry.getValue());
        }
    }
}

```


## å…¶ä»–è¯­è¨€ç‰ˆæœ¬ 

### CPP


```c++

#include <iostream>
#include <map>
 
using namespace std;
 
class ShoppingCartManager {
public:
    // è·å–è´­ç‰©è½¦å®ä¾‹
    static ShoppingCartManager& getInstance() {
        static ShoppingCartManager instance;
        return instance;
    }
 
    // æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
    void addToCart(const string& itemName, int quantity) {
        cart[itemName] += quantity;
    }
 
    // æŸ¥çœ‹è´­ç‰©è½¦
    void viewCart() const {
        for (const auto& item : cart) {
            cout << item.first << " " << item.second << endl;
        }
    }
 
private:
    // ç§æœ‰æ„é€ å‡½æ•°
    ShoppingCartManager() {}
 
    // è´­ç‰©è½¦å­˜å‚¨å•†å“å’Œæ•°é‡çš„æ˜ å°„
    map<string, int> cart;
};
 
int main() {
    string itemName;
    int quantity;
 
    while (cin >> itemName >> quantity) {
        // è·å–è´­ç‰©è½¦å®ä¾‹å¹¶æ·»åŠ å•†å“
        ShoppingCartManager& cart = ShoppingCartManager::getInstance();
        cart.addToCart(itemName, quantity);
    }
 
    // è¾“å‡ºè´­ç‰©è½¦å†…å®¹
    const ShoppingCartManager& cart = ShoppingCartManager::getInstance();
    cart.viewCart();
 
    return 0;
}

```


### Python
1. é¥¿æ±‰æ¨¡å¼


```python

class Singleton:
    instance = None

    def __init__(self):
        if Singleton.instance is not None:
            raise Exception("Only one instance of Singleton class is allowed")
        else:
            Singleton.instance = self

```

2. æ‡’æ±‰æ¨¡å¼


```python

class Singleton:

	__instance: Singleton = None
	
	@staticmethod
	def getInstance():
	    if Singleton.__instance is None:
			Singleton.__instance = Singleton()
	    return Singleton.__instance

```


3. æ‡’æ±‰+åŒé‡é”æ£€æŸ¥


```python

import threading

class Singleton:
	__instance = None
	__lock = threading.Lock()

	@classmethod
	def getInstance(cls):
		if cls.__instance is None:
			with cls.__lock:
				if cls.__instance is None:
					# cls.__instance = super().__new__(cls)
					cls.__instance = Singleton()
		return cls.__instance

```


### Go


```go

package main

import (
	"bufio"
	"fmt"
	"os"
	"strings"
	"sync"
)

// ShoppingCartManager å®ç°è´­ç‰©è½¦ç®¡ç†
type ShoppingCartManager struct {
	cart   map[string]int
	keys   []string // ç”¨äºä¿å­˜æ’å…¥é¡ºåºçš„é”®
	mutext sync.Mutex
}

var once sync.Once
var instance *ShoppingCartManager

// getInstance è·å–è´­ç‰©è½¦å®ä¾‹
func getInstance() *ShoppingCartManager {
	once.Do(func() {
		instance = &ShoppingCartManager{
			cart: make(map[string]int),
		}
	})
	return instance
}

// addToCart å°†å•†å“æ·»åŠ åˆ°è´­ç‰©è½¦
func (scm *ShoppingCartManager) addToCart(itemName string, quantity int) {
	scm.mutext.Lock()
	defer scm.mutext.Unlock()

	// æ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ åˆ° keys ä¸­
	if _, exists := scm.cart[itemName]; !exists {
		scm.keys = append(scm.keys, itemName)
	}

	scm.cart[itemName] += quantity
}

// viewCart æŸ¥çœ‹è´­ç‰©è½¦å†…å®¹å¹¶æŒ‰ç…§æ’å…¥é¡ºåºè¾“å‡º
func (scm *ShoppingCartManager) viewCart() {
	scm.mutext.Lock()
	defer scm.mutext.Unlock()

	for _, itemName := range scm.keys {
		quantity := scm.cart[itemName]
		fmt.Printf("%s %d\n", itemName, quantity)
	}
}

func main() {
	cart := getInstance()
	scanner := bufio.NewScanner(os.Stdin)

	for scanner.Scan() {
		input := scanner.Text()
		if input == "" {
			break
		}
		parts := strings.Fields(input)
		itemName := parts[0]
		quantity := 0
		if len(parts) > 1 {
			fmt.Sscanf(parts[1], "%d", &quantity)
		}

		// è·å–è´­ç‰©è½¦å®ä¾‹å¹¶æ·»åŠ å•†å“
		cart.addToCart(itemName, quantity)
	}

	// è¾“å‡ºè´­ç‰©è½¦å†…å®¹
	cart.viewCart()
}

```

